Changes in module 'nf-core/prokka'
'modules/nf-core/prokka/environment.yml' is unchanged
'modules/nf-core/prokka/meta.yml' is unchanged
Changes in 'prokka/main.nf':
--- modules/nf-core/prokka/main.nf
+++ modules/nf-core/prokka/main.nf
@@ -1,11 +1,11 @@
 process PROKKA {
-    tag "$meta.id"
+    tag "${meta.id}"
     label 'process_low'
 
     conda "${moduleDir}/environment.yml"
     container "${ workflow.containerEngine == 'singularity' && !task.ext.singularity_pull_docker_container ?
-        'https://depot.galaxyproject.org/singularity/prokka:1.14.6--pl5321hdfd78af_4' :
-        'biocontainers/prokka:1.14.6--pl5321hdfd78af_4' }"
+        'oras://community.wave.seqera.io/library/prokka_openjdk:6ee087933c41335a' :
+        'community.wave.seqera.io/library/prokka_openjdk:fa5e94a172289f67' }"
 
     input:
     tuple val(meta), path(fasta)
@@ -31,18 +31,26 @@
     task.ext.when == null || task.ext.when
 
     script:
-    def args = task.ext.args   ?: ''
-    prefix   = task.ext.prefix ?: "${meta.id}"
-    def proteins_opt = proteins ? "--proteins ${proteins[0]}" : ""
-    def prodigal_tf = prodigal_tf ? "--prodigaltf ${prodigal_tf[0]}" : ""
+    def args             = task.ext.args   ?: ''
+    prefix               = task.ext.prefix ?: "${meta.id}"
+    def fasta_compressed = fasta.getExtension() == "gz" ? true : false
+    def input            = fasta_compressed ? fasta.toString() - ~/\.gz$/ : fasta
+    def decompress       = fasta_compressed ? "gunzip -c ${fasta} > ${input}" : ""
+    def cleanup          = fasta_compressed ? "rm ${input}" : ""
+    def proteins_opt     = proteins ? "--proteins ${proteins}" : ""
+    def prodigal_tf_in   = prodigal_tf ? "--prodigaltf ${prodigal_tf}" : ""
     """
+    ${decompress}
+
     prokka \\
-        $args \\
-        --cpus $task.cpus \\
-        --prefix $prefix \\
-        $proteins_opt \\
-        $prodigal_tf \\
-        $fasta
+        ${args} \\
+        --cpus ${task.cpus} \\
+        --prefix ${prefix} \\
+        ${proteins_opt} \\
+        ${prodigal_tf_in} \\
+        ${input}
+
+    ${cleanup}
 
     cat <<-END_VERSIONS > versions.yml
     "${task.process}":

'modules/nf-core/prokka/tests/tags.yml' is unchanged
'modules/nf-core/prokka/tests/main.nf.test' is unchanged
'modules/nf-core/prokka/tests/main.nf.test.snap' is unchanged
************************************************************
